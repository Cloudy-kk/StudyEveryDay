# JS

## this

### call()å’Œapply()çš„åŒºåˆ«

- å®ƒä»¬çš„ä½œç”¨ä¸€æ¨¡ä¸€æ ·ï¼ŒåŒºåˆ«ä»…åœ¨äºä¼ å…¥å‚æ•°çš„å½¢å¼çš„ä¸åŒã€‚
 apply æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†å‡½æ•°ä½“å†… this å¯¹è±¡çš„æŒ‡å‘ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¸¦ä¸‹æ ‡çš„é›†åˆï¼Œè¿™ä¸ªé›†åˆå¯ä»¥ä¸ºæ•°ç»„ï¼Œä¹Ÿå¯ä»¥ä¸ºç±»æ•°ç»„ï¼Œapply æ–¹æ³•æŠŠè¿™ä¸ªé›†åˆä¸­çš„å…ƒç´ ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°ã€‚
 call ä¼ å…¥çš„å‚æ•°æ•°é‡ä¸å›ºå®šï¼Œè·Ÿ apply ç›¸åŒçš„æ˜¯ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿæ˜¯ä»£è¡¨å‡½æ•°ä½“å†…çš„ this æŒ‡å‘ï¼Œä»ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹å¾€åï¼Œæ¯ä¸ªå‚æ•°è¢«ä¾æ¬¡ä¼ å…¥å‡½æ•°ã€‚
  - `this`å¯¹è±¡æ˜¯æ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒæŒ‡å‘æœ€åä¸€æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡ï¼Œåœ¨å…¨å±€å‡½æ•°ä¸­ï¼Œ`this`ç­‰äº`window`ï¼Œè€Œå½“å‡½æ•°è¢«ä½œä¸ºæŸä¸ªå¯¹è±¡è°ƒç”¨æ—¶ï¼Œthisç­‰äºé‚£ä¸ªå¯¹è±¡ã€‚ åœ¨å®é™…å¼€å‘ä¸­ï¼Œ`this` çš„æŒ‡å‘å¯ä»¥é€šè¿‡å››ç§è°ƒç”¨æ¨¡å¼æ¥åˆ¤æ–­ã€‚
  1. **å‡½æ•°è°ƒç”¨**ï¼Œå½“ä¸€ä¸ªå‡½æ•°ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œç›´æ¥ä½œä¸ºå‡½æ•°æ¥è°ƒç”¨æ—¶ï¼Œ`this`æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚
  2. **æ–¹æ³•è°ƒç”¨**ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°ä½œä¸ºä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•æ¥è°ƒç”¨æ—¶ï¼Œ`this`æŒ‡å‘è¿™ä¸ªå¯¹è±¡ã€‚
  3. **æ„é€ å‡½æ•°è°ƒç”¨**ï¼Œ`this`æŒ‡å‘è¿™ä¸ªç”¨`new`æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚
  4. **ç¬¬å››ç§æ˜¯ ****`apply ã€ call å’Œ bind`**** è°ƒç”¨æ¨¡å¼**ï¼Œè¿™ä¸‰ä¸ªæ–¹æ³•éƒ½å¯ä»¥æ˜¾ç¤ºçš„æŒ‡å®šè°ƒç”¨å‡½æ•°çš„ this æŒ‡å‘ã€‚å…¶ä¸­ apply æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯ this ç»‘å®šçš„å¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯å‚æ•°æ•°ç»„ã€‚call æ–¹æ³•æ¥æ”¶çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ this ç»‘å®šçš„å¯¹è±¡ï¼Œåé¢çš„å…¶ä½™å‚æ•°æ˜¯ä¼ å…¥å‡½æ•°æ‰§è¡Œçš„å‚æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä½¿ç”¨ call() æ–¹æ³•æ—¶ï¼Œä¼ é€’ç»™å‡½æ•°çš„å‚æ•°å¿…é¡»é€ä¸ªåˆ—ä¸¾å‡ºæ¥ã€‚bind æ–¹æ³•é€šè¿‡ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ª this ç»‘å®šäº†ä¼ å…¥å¯¹è±¡çš„æ–°å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°çš„ this æŒ‡å‘é™¤äº†ä½¿ç”¨ new æ—¶ä¼šè¢«æ”¹å˜ï¼Œå…¶ä»–æƒ…å†µä¸‹éƒ½ä¸ä¼šæ”¹å˜ã€‚

### å®ç°callï¼Œapplyï¼Œbindå‡½æ•°

- **ï¼ˆ1ï¼‰call å‡½æ•°çš„å®ç°æ­¥éª¤ï¼š**
- åˆ¤æ–­è°ƒç”¨å¯¹è±¡æ˜¯å¦ä¸ºå‡½æ•°ï¼Œå³ä½¿æ˜¯å®šä¹‰åœ¨å‡½æ•°çš„åŸå‹ä¸Šçš„ï¼Œä½†æ˜¯å¯èƒ½å‡ºç°ä½¿ç”¨ call ç­‰æ–¹å¼è°ƒç”¨çš„æƒ…å†µã€‚
- åˆ¤æ–­ä¼ å…¥ä¸Šä¸‹æ–‡å¯¹è±¡æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®ä¸º window ã€‚
- å¤„ç†ä¼ å…¥çš„å‚æ•°ï¼Œæˆªå–ç¬¬ä¸€ä¸ªå‚æ•°åçš„æ‰€æœ‰å‚æ•°ã€‚
- å°†å‡½æ•°ä½œä¸ºä¸Šä¸‹æ–‡å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚
- ä½¿ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ä¿å­˜è¿”å›ç»“æœã€‚
- åˆ é™¤åˆšæ‰æ–°å¢çš„å±æ€§ã€‚
- è¿”å›ç»“æœã€‚

 ```javascript
 Function.prototype.myCall = function(context) {
 // åˆ¤æ–­è°ƒç”¨å¯¹è±¡
 if (typeof this !== "function") {
   console.error("type error");
 }
 // è·å–å‚æ•°
 let args = [...arguments].slice(1),
   result = null;
 // åˆ¤æ–­ context æ˜¯å¦ä¼ å…¥ï¼Œå¦‚æœæœªä¼ å…¥åˆ™è®¾ç½®ä¸º window
 context = context || window;
 // å°†è°ƒç”¨å‡½æ•°è®¾ä¸ºå¯¹è±¡çš„æ–¹æ³•
 context.fn = this;
 // è°ƒç”¨å‡½æ•°
 result = context.fn(...args);
 // å°†å±æ€§åˆ é™¤
 delete context.fn;
 return result;
 };
 
 ```

- **ï¼ˆ2ï¼‰apply å‡½æ•°çš„å®ç°æ­¥éª¤ï¼š**
- åˆ¤æ–­è°ƒç”¨å¯¹è±¡æ˜¯å¦ä¸ºå‡½æ•°ï¼Œå³ä½¿æ˜¯å®šä¹‰åœ¨å‡½æ•°çš„åŸå‹ä¸Šçš„ï¼Œä½†æ˜¯å¯èƒ½å‡ºç°ä½¿ç”¨ call ç­‰æ–¹å¼è°ƒç”¨çš„æƒ…å†µã€‚
- åˆ¤æ–­ä¼ å…¥ä¸Šä¸‹æ–‡å¯¹è±¡æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®ä¸º window ã€‚
- å°†å‡½æ•°ä½œä¸ºä¸Šä¸‹æ–‡å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚
- åˆ¤æ–­å‚æ•°å€¼æ˜¯å¦ä¼ å…¥
- ä½¿ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ä¿å­˜è¿”å›ç»“æœã€‚
- åˆ é™¤åˆšæ‰æ–°å¢çš„å±æ€§
- è¿”å›ç»“æœ

 ```javascript
 Function.prototype.myApply = function(context) {
 // åˆ¤æ–­è°ƒç”¨å¯¹è±¡æ˜¯å¦ä¸ºå‡½æ•°
 if (typeof this !== "function") {
   throw new TypeError("Error");
 }
 let result = null;
 // åˆ¤æ–­ context æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæœªä¼ å…¥åˆ™ä¸º window
 context = context || window;
 // å°†å‡½æ•°è®¾ä¸ºå¯¹è±¡çš„æ–¹æ³•
 context.fn = this;
 // è°ƒç”¨æ–¹æ³•
 if (arguments[1]) {
   result = context.fn(...arguments[1]);
 } else {
   result = context.fn();
 }
 // å°†å±æ€§åˆ é™¤
 delete context.fn;
 return result;
 
 };
 
 ```

- **ï¼ˆ3ï¼‰bind å‡½æ•°çš„å®ç°æ­¥éª¤ï¼š**
- åˆ¤æ–­è°ƒç”¨å¯¹è±¡æ˜¯å¦ä¸ºå‡½æ•°ï¼Œå³ä½¿æ˜¯å®šä¹‰åœ¨å‡½æ•°çš„åŸå‹ä¸Šçš„ï¼Œä½†æ˜¯å¯èƒ½å‡ºç°ä½¿ç”¨ call ç­‰æ–¹å¼è°ƒç”¨çš„æƒ…å†µã€‚
- ä¿å­˜å½“å‰å‡½æ•°çš„å¼•ç”¨ï¼Œè·å–å…¶ä½™ä¼ å…¥å‚æ•°å€¼ã€‚
- åˆ›å»ºä¸€ä¸ªå‡½æ•°è¿”å›
- å‡½æ•°å†…éƒ¨ä½¿ç”¨ apply æ¥ç»‘å®šå‡½æ•°è°ƒç”¨ï¼Œéœ€è¦åˆ¤æ–­å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ä¼ å…¥å½“å‰å‡½æ•°çš„ this ç»™ apply è°ƒç”¨ï¼Œå…¶ä½™æƒ…å†µéƒ½ä¼ å…¥æŒ‡å®šçš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚

 ```javascript
 Function.prototype.myBind = function(context) {
 // åˆ¤æ–­è°ƒç”¨å¯¹è±¡æ˜¯å¦ä¸ºå‡½æ•°
 if (typeof this !== "function") {
   throw new TypeError("Error");
 }
 // è·å–å‚æ•°
 var args = [...arguments].slice(1),
   fn = this;
 return function Fn() {
   // æ ¹æ®è°ƒç”¨æ–¹å¼ï¼Œä¼ å…¥ä¸åŒç»‘å®šå€¼
   return fn.apply(
     this instanceof Fn ? this : context,
     args.concat(...arguments)
   );
 };
 };
 
 ```

## jsæ•°æ®ç±»å‹ã€typeofã€instanceofã€ç±»å‹è½¬æ¢

1. **`stringã€numberã€booleanã€nullã€undefinedã€object(functionã€array)ã€symbol(ES10 BigInt)`**
2. `typeof` ä¸»è¦ç”¨æ¥åˆ¤æ–­æ•°æ®ç±»å‹ è¿”å›å€¼æœ‰`stringã€booleanã€numberã€functionã€objectã€undefinedã€‚`

 ```javascript
 typeof null  // 'object'
 typeof undefined  // 'undefined'
 ```

 ```javascript
 null == undefined  // true
 null === undefined  // false
 !!null === !!undefined  // true
 ```

3. `instanceof` åˆ¤æ–­è¯¥å¯¹è±¡æ˜¯è°çš„å®ä¾‹ã€‚
4. `null`è¡¨ç¤ºç©ºå¯¹è±¡ `undefined`è¡¨ç¤ºå·²åœ¨ä½œç”¨åŸŸä¸­å£°æ˜ä½†æœªèµ‹å€¼çš„å˜é‡
5. **`null`****è½¬åŒ–ä¸º ****`number`**** æ—¶ï¼Œä¼šè½¬æ¢æˆ****`0`**
 `undefined` è½¬æ¢ä¸º `number` æ—¶ï¼Œä¼šè½¬æ¢ä¸º `NaN`
 å­˜åœ¨æŒ‡é’ˆï¼Œæ‰¾ä¸åˆ°ä¸œè¥¿ nullã€‚ ä¸å­˜åœ¨æŒ‡é’ˆundefined
6. **ä¹Ÿå¯ä»¥ä½¿ç”¨**`**Object.prototype.toString.call([])**`**åˆ¤æ–­æ•°æ®ç±»å‹**

### typeof

```javascript
console.log(typeof 1);               // number
console.log(typeof true);            // boolean
console.log(typeof 'mc');            // string
console.log(typeof Symbol)           // function
console.log(typeof function(){});    // function
console.log(typeof console.log());   // function
console.log(typeof []);              // object 
console.log(typeof {});              // object
console.log(typeof null);            // object
console.log(typeof undefined);       // undefined


ä¼˜ç‚¹ï¼šèƒ½å¤Ÿå¿«é€ŸåŒºåˆ†åŸºæœ¬æ•°æ®ç±»å‹
ç¼ºç‚¹ï¼šä¸èƒ½å°†Objectã€Arrayå’ŒNullåŒºåˆ†ï¼Œéƒ½è¿”å›object

```

### instanceofå®ç°åŸç†

leftVaule instanceof rightVauleï¼ˆé€šè¿‡æ¯”è¾ƒä»–ä»¬ä¹‹é—´çš„åŸå‹å¯¹è±¡ï¼‰å³å®ä¾‹å¯¹è±¡ä¸Šé¢çš„_proto_æŒ‡å‘çš„åŸå‹å¯¹è±¡å’Œæ„é€ å‡½æ•°prototypeå±æ€§çš„åŸå‹å¯¹è±¡æŒ‡å‘çš„æ˜¯ä¸€ä¸ªå€¼ã€‚

```javascript
nceof
console.log(1 instanceof Number);                    // false
console.log(true instanceof Boolean);                // false 
console.log('str' instanceof String);                // false  
console.log([] instanceof Array);                    // true
console.log(function(){} instanceof Function);       // true
console.log({} instanceof Object);                   // true

ä¼˜ç‚¹ï¼šèƒ½å¤ŸåŒºåˆ†Arrayã€Objectå’ŒFunctionï¼Œé€‚åˆç”¨äºåˆ¤æ–­è‡ªå®šä¹‰çš„ç±»å®ä¾‹å¯¹è±¡
ç¼ºç‚¹ï¼šNumberï¼ŒBooleanï¼ŒStringåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½åˆ¤æ–­

```

```javascript
function myInstanceof(left, right) {
    let proto = Object.getPrototypeOf(left);//protoæ˜¯leftçš„åŸå‹å¯¹è±¡
    while(true) {
        if(proto == null) return false; //ç›´åˆ°æ‰¾åˆ°nullçš„æ—¶å€™è¿”å›falseï¼Œå¾ªç¯ç»“æŸ
        if(proto == right.prototype) return true;
        proto = Object.getPrototypeof(proto);
    }
}
console.log(myInstanceof('hello',String)); 

```

![123](image/image.png "")

### Object.prototype.toString.call()

```javascript
var toString = Object.prototype.toString;

console.log(toString.call(1));                      //[object Number]
console.log(toString.call(true));                   //[object Boolean]
console.log(toString.call('mc'));                   //[object String]
console.log(toString.call([]));                     //[object Array]
console.log(toString.call({}));                     //[object Object]
console.log(toString.call(function(){}));           //[object Function]
console.log(toString.call(undefined));              //[object Undefined]
console.log(toString.call(null));                   //[object Null]

```

## var && let && const

- varå®šä¹‰çš„å˜é‡ï¼Œ`æ²¡æœ‰å—çš„æ¦‚å¿µï¼Œå¯ä»¥è·¨å—è®¿é—®`, ä¸èƒ½è·¨å‡½æ•°è®¿é—®ã€‚  
 letå®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨å—ä½œç”¨åŸŸé‡Œè®¿é—®ï¼Œä¸èƒ½è·¨å—è®¿é—®ï¼Œä¹Ÿä¸èƒ½è·¨å‡½æ•°è®¿é—®ã€‚  
 constç”¨æ¥å®šä¹‰å¸¸é‡ï¼Œä½¿ç”¨æ—¶å¿…é¡»åˆå§‹åŒ–(å³å¿…é¡»èµ‹å€¼)ï¼Œåªèƒ½åœ¨å—ä½œç”¨åŸŸé‡Œè®¿é—®ï¼Œä¸”ä¸èƒ½ä¿®æ”¹ã€‚
- varå¯ä»¥`å…ˆä½¿ç”¨ï¼Œåå£°æ˜`ï¼Œå› ä¸ºå­˜åœ¨å˜é‡æå‡ï¼›letå¿…é¡»å…ˆå£°æ˜åä½¿ç”¨ã€‚
- varæ˜¯å…è®¸åœ¨ç›¸åŒä½œç”¨åŸŸå†…`é‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡`çš„ï¼Œè€Œletä¸constä¸å…è®¸è¿™ä¸€ç°è±¡ã€‚
- åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­ï¼ŒåŸºäºletå£°æ˜çš„å…¨å±€å˜é‡å’Œå…¨å±€å¯¹è±¡GOï¼ˆwindowï¼‰æ²¡æœ‰ä»»ä½•å…³ç³» ;  
 varå£°æ˜çš„å˜é‡ä¼šå’ŒGOæœ‰æ˜ å°„å…³ç³»ï¼›
- let /const/functionä¼šæŠŠå½“å‰æ‰€åœ¨çš„å¤§æ‹¬å·(é™¤å‡½æ•°ä¹‹å¤–)ä½œä¸ºä¸€ä¸ªå…¨æ–°çš„å—çº§ä¸Šä¸‹æ–‡ï¼Œåº”ç”¨è¿™ä¸ªæœºåˆ¶ï¼Œåœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œé‡åˆ°å¾ªç¯äº‹ä»¶ç»‘å®šç­‰ç±»ä¼¼çš„éœ€æ±‚ï¼Œæ— éœ€å†è‡ªå·±æ„å»ºé—­åŒ…æ¥å­˜å‚¨ï¼Œåªè¦åŸºäºletçš„å—ä½œç”¨ç‰¹å¾å³å¯è§£å†³

### æš‚æ—¶æ€§æ­»åŒº

ES6 ä¸­æœ‰æ˜ç¡®çš„è§„å®šï¼šå¦‚æœåŒºå—ä¸­å­˜åœ¨ let å’Œ const å‘½ä»¤ï¼Œè¿™ä¸ªåŒºå—å¯¹è¿™äº›å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œä»ä¸€å¼€å§‹å°±å½¢æˆäº†å°é—­ä½œç”¨åŸŸã€‚å‡å¦‚æˆ‘ä»¬å°è¯•åœ¨å£°æ˜å‰å»ä½¿ç”¨è¿™ç±»å˜é‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚

è¿™ä¸€æ®µä¼šæŠ¥é”™çš„å±é™©åŒºåŸŸï¼Œæœ‰ä¸€ä¸ªä¸“å±çš„åå­—ï¼Œå«â€æš‚æ—¶æ€§æ­»åŒºâ€œã€‚åœ¨æˆ‘ä»¬çš„ demo ä¸­ï¼Œä»¥çº¢çº¿ä¸ºç•Œï¼Œä¸Šé¢çš„åŒºåŸŸå°±æ˜¯æš‚æ—¶æ€§æ­»åŒºï¼š

```javascript
var me = 'icon';

{
  me = 'lee';
  ---------------------------ä¸Šé¢å°±æ˜¯æš‚æ—¶æ€§æ­»åŒºï¼ˆä¼šæŠ¥é”™ï¼‰
  let me;
}
```

å› ä¸ºletå¹¶ä¸ä¼šæœ‰å£°æ˜æå‡ï¼Œæ‰€ä»¥ä¸Šé¢çš„å†…å®¹{}ä¼šæŠ¥é”™ã€‚

## ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾

## é—­åŒ…

é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡çš„å‡½æ•° â€”â€”ã€Šjavascripté«˜çº§ç¨‹åºè®¾è®¡ã€‹

åœ¨jsä¸­å˜é‡çš„ä½œç”¨åŸŸå±äºå‡½æ•°ä½œç”¨åŸŸ, åœ¨å‡½æ•°æ‰§è¡Œå®Œå,ä½œç”¨åŸŸå°±ä¼šè¢«æ¸…ç†,å†…å­˜ä¹Ÿä¼šéšä¹‹è¢«å›æ”¶,ä½†æ˜¯ç”±äºé—­åŒ…å‡½æ•°æ˜¯å»ºç«‹åœ¨å‡½æ•°å†…éƒ¨çš„å­å‡½æ•°, ç”±äºå…¶å¯è®¿é—®ä¸Šçº§ä½œç”¨åŸŸ,å³ä½¿ä¸Šçº§å‡½æ•°æ‰§è¡Œå®Œ, ä½œç”¨åŸŸä¹Ÿä¸ä¼šéšä¹‹é”€æ¯, è¿™æ—¶çš„å­å‡½æ•°(ä¹Ÿå°±æ˜¯é—­åŒ…),ä¾¿æ‹¥æœ‰äº†è®¿é—®ä¸Šçº§ä½œç”¨åŸŸä¸­å˜é‡çš„æƒé™,å³ä½¿ä¸Šçº§å‡½æ•°æ‰§è¡Œå®Œåä½œç”¨åŸŸå†…çš„å€¼ä¹Ÿä¸ä¼šè¢«é”€æ¯

**é—­åŒ…ä¸­çš„å˜é‡å­˜å‚¨çš„ä½ç½®æ˜¯å †å†…å­˜ã€‚**

- é—­åŒ…ç”¨é€”ï¼š

 1. èƒ½å¤Ÿè®¿é—®å‡½æ•°å®šä¹‰æ—¶æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸ(é˜»æ­¢å…¶è¢«å›æ”¶)
 2. ç§æœ‰åŒ–å˜é‡
 3. æ¨¡æ‹Ÿå—çº§ä½œç”¨åŸŸ
 4. åˆ›å»ºæ¨¡å—

- é—­åŒ…ç¼ºç‚¹ï¼šä¼šå¯¼è‡´å‡½æ•°çš„å˜é‡ä¸€ç›´ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿‡å¤šçš„é—­åŒ…å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼

**é—­åŒ…åº”ç”¨åœºæ™¯**

é—­åŒ…çš„ä¸¤ä¸ªåœºæ™¯ï¼Œé—­åŒ…çš„ä¸¤å¤§ä½œç”¨ï¼š`ä¿å­˜/ä¿æŠ¤`ã€‚ åœ¨å¼€å‘ä¸­, å…¶å®æˆ‘ä»¬éšå¤„å¯è§é—­åŒ…çš„èº«å½±, å¤§éƒ¨åˆ†å‰ç«¯javascript ä»£ç éƒ½æ˜¯â€œäº‹ä»¶é©±åŠ¨â€çš„,å³ä¸€ä¸ªäº‹ä»¶ç»‘å®šçš„å›è°ƒæ–¹æ³•; å‘é€ajaxè¯·æ±‚æˆåŠŸ|å¤±è´¥çš„å›è°ƒ;setTimeoutçš„å»¶æ—¶å›è°ƒ;æˆ–è€…ä¸€ä¸ªå‡½æ•°å†…éƒ¨è¿”å›å¦ä¸€ä¸ªåŒ¿åå‡½æ•°,è¿™äº›éƒ½æ˜¯é—­åŒ…çš„åº”ç”¨ã€‚

## åŸå‹/åŸå‹é“¾

### **åŸå‹:**

å¯¹è±¡ä¸­å›ºæœ‰çš„__proto__å±æ€§ï¼Œè¯¥å±æ€§æŒ‡å‘å¯¹è±¡çš„prototypeåŸå‹å±æ€§ã€‚

### **åŸå‹é“¾:**

 å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡å†…éƒ¨ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå»å®ƒçš„åŸå‹å¯¹è±¡é‡Œæ‰¾è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡åˆä¼šæœ‰è‡ªå·±çš„åŸå‹ï¼Œäºæ˜¯å°±è¿™æ ·ä¸€ç›´æ‰¾ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯åŸå‹é“¾çš„æ¦‚å¿µã€‚åŸå‹é“¾çš„å°½å¤´ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯**Object.prototype**æ‰€ä»¥è¿™å°±æ˜¯æˆ‘ä»¬æ–°å»ºçš„å¯¹è±¡ä¸ºä»€ä¹ˆèƒ½å¤Ÿä½¿ç”¨toString()ç­‰æ–¹æ³•çš„åŸå› ã€‚

### **ç‰¹ç‚¹:**

javascriptå¯¹è±¡æ˜¯é€šè¿‡å¼•ç”¨æ¥ä¼ é€’çš„ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ¯ä¸ªæ–°å¯¹è±¡å®ä½“ä¸­å¹¶æ²¡æœ‰ä¸€ä»½å±äºè‡ªå·±çš„åŸå‹å‰¯æœ¬ã€‚å½“æˆ‘ä»¬ä¿®æ”¹åŸå‹æ—¶ï¼Œä¸ä¹‹ç›¸å…³çš„å¯¹è±¡ä¹Ÿä¼šç»§æ‰¿è¿™ä¸€æ”¹å˜ã€‚
thisæŒ‡å‘ã€newå…³é”®å­—

## newå…³é”®å­—

1. é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª**æ–°çš„ç©ºå¯¹è±¡**
2. **è®¾ç½®åŸå‹**ï¼Œå°†å¯¹è±¡çš„åŸå‹è®¾ç½®ä¸ºå‡½æ•°çš„`prototype`å¯¹è±¡ã€‚
3. **è®©å‡½æ•°çš„****`this`****æŒ‡å‘è¿™ä¸ªå¯¹è±¡**ï¼Œæ‰§è¡Œæ„é€ å‡½æ•°çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰
4. åˆ¤æ–­å‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼Œå¦‚æœæ˜¯å€¼ç±»å‹ï¼Œè¿”å›åˆ›å»ºçš„å¯¹è±¡ã€‚å¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œå°±è¿”å›è¿™ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡ã€‚

## æ‰§è¡Œä¸Šä¸‹æ–‡

æ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯å½“å‰ javascript ä»£ç è¢«è§£æå’Œæ‰§è¡Œæ—¶æ‰€åœ¨ç¯å¢ƒçš„æŠ½è±¡æ¦‚å¿µï¼Œ javascript ä¸­è¿è¡Œä»»ä½•çš„ä»£ç éƒ½æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¿è¡Œ

- å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š è¿™æ˜¯é»˜è®¤çš„ã€æœ€åŸºç¡€çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ä¸åœ¨ä»»ä½•å‡½æ•°ä¸­çš„ä»£ç éƒ½ä½äºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ã€‚å®ƒåšäº†ä¸¤ä»¶äº‹ï¼š1. åˆ›å»ºä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­è¿™ä¸ªå…¨å±€å¯¹è±¡å°±æ˜¯ window å¯¹è±¡ã€‚2. å°† this æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªå…¨å±€å¯¹è±¡ã€‚ä¸€ä¸ªç¨‹åºä¸­åªèƒ½å­˜åœ¨ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚
- å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š æ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶ï¼Œéƒ½ä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚æ¯ä¸ªå‡½æ•°éƒ½æ‹¥æœ‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯åªæœ‰åœ¨å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™æ‰ä¼šè¢«åˆ›å»ºã€‚ä¸€ä¸ªç¨‹åºä¸­å¯ä»¥å­˜åœ¨ä»»æ„æ•°é‡çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚æ¯å½“ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºï¼Œå®ƒéƒ½ä¼šæŒ‰ç…§ç‰¹å®šçš„é¡ºåºæ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤ï¼Œå…·ä½“è¿‡ç¨‹å°†åœ¨æœ¬æ–‡åé¢è®¨è®ºã€‚
- Eval å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š è¿è¡Œåœ¨ eval å‡½æ•°ä¸­çš„ä»£ç ä¹Ÿè·å¾—äº†è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†ç”±äº javascript å¼€å‘äººå‘˜ä¸å¸¸ç”¨ eval å‡½æ•°ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä¸å†è®¨è®º
æ‰§è¡Œä¸Šä¸‹æ–‡çš„ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µï¼š**åˆ›å»ºé˜¶æ®µâ†’æ‰§è¡Œé˜¶æ®µâ†’å›æ”¶é˜¶æ®µ**

### 1.åˆ›å»ºé˜¶æ®µ

å½“å‡½æ•°è¢«è°ƒç”¨ï¼Œä½†æœªæ‰§è¡Œä»»ä½•å…¶å†…éƒ¨ä»£ç ä¹‹å‰ï¼Œä¼šåšä»¥ä¸‹ä¸‰ä»¶äº‹ï¼š

- åˆ›å»ºå˜é‡å¯¹è±¡ï¼šé¦–å…ˆåˆ**å§‹åŒ–å‡½æ•°çš„å‚æ•°argumentsï¼Œæå‡å‡½æ•°å£°æ˜å’Œå˜é‡å£°æ˜**ã€‚ä¸‹æ–‡ä¼šè¯¦ç»†è¯´æ˜ã€‚
- **åˆ›å»ºä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰**ï¼šåœ¨æ‰§è¡ŒæœŸä¸Šä¸‹æ–‡çš„åˆ›å»ºé˜¶æ®µï¼Œä½œç”¨åŸŸé“¾æ˜¯åœ¨å˜é‡å¯¹è±¡ä¹‹ååˆ›å»ºçš„ã€‚ä½œç”¨åŸŸé“¾æœ¬èº«åŒ…å«å˜é‡å¯¹è±¡ã€‚ä½œç”¨åŸŸé“¾ç”¨äºè§£æå˜é‡ã€‚å½“è¢«è¦æ±‚è§£æå˜é‡æ—¶ï¼Œjavascript å§‹ç»ˆä»ä»£ç åµŒå¥—çš„æœ€å†…å±‚å¼€å§‹ï¼Œå¦‚æœæœ€å†…å±‚æ²¡æœ‰æ‰¾åˆ°å˜é‡ï¼Œå°±ä¼šè·³è½¬åˆ°ä¸Šä¸€å±‚çˆ¶ä½œç”¨åŸŸä¸­æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å˜é‡ã€‚
- **ç¡®å®šthisæŒ‡å‘**ï¼šåŒ…æ‹¬å¤šç§æƒ…å†µï¼Œä¸‹æ–‡ä¼šè¯¦ç»†è¯´æ˜

åœ¨ä¸€æ®µ JS è„šæœ¬æ‰§è¡Œä¹‹å‰ï¼Œè¦å…ˆè§£æä»£ç ï¼ˆæ‰€ä»¥è¯´ JS æ˜¯è§£é‡Šæ‰§è¡Œçš„è„šæœ¬è¯­è¨€ï¼‰ï¼Œè§£æçš„æ—¶å€™ä¼šå…ˆåˆ›å»ºä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå…ˆæŠŠä»£ç ä¸­å³å°†æ‰§è¡Œçš„å˜é‡ã€å‡½æ•°å£°æ˜éƒ½æ‹¿å‡ºæ¥ã€‚å˜é‡å…ˆæš‚æ—¶èµ‹å€¼ä¸ºundefinedï¼Œå‡½æ•°åˆ™å…ˆå£°æ˜å¥½å¯ä½¿ç”¨ã€‚è¿™ä¸€æ­¥åšå®Œäº†ï¼Œç„¶åå†å¼€å§‹æ­£å¼æ‰§è¡Œç¨‹åºã€‚

å¦å¤–ï¼Œä¸€ä¸ªå‡½æ•°åœ¨æ‰§è¡Œä¹‹å‰ï¼Œä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œè·Ÿå…¨å±€ä¸Šä¸‹æ–‡å·®ä¸å¤šï¼Œä¸è¿‡ å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ä¼šå¤šå‡ºthis argumentså’Œå‡½æ•°çš„å‚æ•°ã€‚

### 2.æ‰§è¡Œé˜¶æ®µ

æ‰§è¡Œå˜é‡èµ‹å€¼ã€ä»£ç æ‰§è¡Œ

### 3.å›æ”¶é˜¶æ®µ

æ‰§è¡Œä¸Šä¸‹æ–‡å‡ºæ ˆç­‰å¾…è™šæ‹Ÿæœºå›æ”¶æ‰§è¡Œä¸Šä¸‹æ–‡

## åƒåœ¾å›æ”¶æœºåˆ¶

é‡åˆ°å‡½æ•°çš„æ—¶å€™ï¼Œä¼šä¸ºå…¶åˆ›å»ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡(Context)ç¯å¢ƒå¹¶æ·»åŠ åˆ°è°ƒç”¨å †æ ˆçš„æ ˆé¡¶ï¼Œå‡½æ•°çš„ä½œç”¨åŸŸ(handleScope)ä¸­åŒ…å«äº†è¯¥å‡½æ•°ä¸­å£°æ˜çš„æ‰€æœ‰å˜é‡ï¼Œå½“è¯¥å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä»æ ˆé¡¶å¼¹å‡ºï¼Œå‡½æ•°çš„ä½œç”¨åŸŸä¼šéšä¹‹é”€æ¯ï¼Œå…¶åŒ…å«çš„æ‰€æœ‰å˜é‡ä¹Ÿä¼šç»Ÿä¸€é‡Šæ”¾å¹¶è¢«è‡ªåŠ¨å›æ”¶ã€‚

è¯•æƒ³å¦‚æœåœ¨è¿™ä¸ªä½œç”¨åŸŸè¢«é”€æ¯çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä¸­çš„å˜é‡ä¸è¢«å›æ”¶ï¼Œå³æŒä¹…å ç”¨å†…å­˜ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šå¯¼è‡´å†…å­˜æš´å¢ï¼Œä»è€Œå¼•å‘å†…å­˜æ³„æ¼å¯¼è‡´ç¨‹åºçš„æ€§èƒ½ç›´çº¿ä¸‹é™ç”šè‡³å´©æºƒï¼Œå› æ­¤å†…å­˜åœ¨ä½¿ç”¨å®Œæ¯•ä¹‹åç†å½“å½’è¿˜ç»™æ“ä½œç³»ç»Ÿä»¥ä¿è¯å†…å­˜çš„é‡å¤åˆ©ç”¨ã€‚

### åƒåœ¾å›æ”¶ç­–ç•¥

#### æ ‡è®°æ¸…é™¤ç®—æ³•

è¯¥ç®—æ³•å‡å®šè®¾ç½®ä¸€ä¸ªå«åš**æ ¹ï¼ˆrootï¼‰çš„å¯¹è±¡**ï¼ˆåœ¨javascripté‡Œï¼Œæ ¹æ˜¯å…¨å±€å¯¹è±¡ï¼‰ã€‚åƒåœ¾å›æ”¶å™¨å°†**å®šæœŸä»æ ¹å¼€å§‹**ï¼ˆåœ¨JSä¸­å°±æ˜¯å…¨å±€å¯¹è±¡ï¼‰æ‰«æå†…å­˜ä¸­çš„å¯¹è±¡ã€‚**å‡¡æ˜¯èƒ½ä»æ ¹éƒ¨åˆ°è¾¾çš„å¯¹è±¡ï¼Œéƒ½æ˜¯è¿˜éœ€è¦ä½¿ç”¨çš„ã€‚é‚£äº›æ— æ³•ç”±æ ¹éƒ¨å‡ºå‘è§¦åŠåˆ°çš„å¯¹è±¡è¢«æ ‡è®°ä¸ºä¸å†ä½¿ç”¨ï¼Œç¨åè¿›è¡Œå›æ”¶**ã€‚

1. å˜é‡è¿›å…¥ä¸Šä¸‹æ–‡ï¼Œä¹Ÿå¯ç†è§£ä¸ºä½œç”¨åŸŸï¼Œä¼šåŠ ä¸Šæ ‡è®°ï¼Œè¯æ˜å…¶å­˜åœ¨äºè¯¥ä¸Šä¸‹æ–‡ï¼›
2. å°†**æ‰€æœ‰åœ¨ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ä»¥åŠä¸Šä¸‹æ–‡ä¸­è¢«è®¿é—®å¼•ç”¨çš„å˜é‡**æ ‡è®°å»æ‰ï¼Œè¡¨æ˜è¿™äº›å˜é‡æ´»è·ƒæœ‰ç”¨ï¼›
3. åœ¨æ­¤ä¹‹åå†è¢«åŠ ä¸Šæ ‡è®°çš„å˜é‡æ ‡è®°ä¸ºå‡†å¤‡åˆ é™¤çš„å˜é‡ï¼Œå› ä¸ºä¸Šä¸‹æ–‡ä¸­çš„å˜é‡å·²ç»æ— æ³•è®¿é—®å®ƒä»¬ï¼›
4. æ‰§è¡Œå†…å­˜æ¸…ç†ï¼Œé”€æ¯å¸¦æ ‡è®°çš„æ‰€æœ‰éæ´»è·ƒå€¼å¹¶å›æ”¶ä¹‹å‰è¢«å ç”¨çš„å†…å­˜ï¼›

- **æ ‡è®°é˜¶æ®µ**ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šä»æ ¹å¯¹è±¡å¼€å§‹éå†ã€‚æ¯ä¸€ä¸ªå¯ä»¥ä»æ ¹å¯¹è±¡è®¿é—®åˆ°çš„å¯¹è±¡éƒ½ä¼šè¢«æ·»åŠ ä¸€ä¸ªæ ‡è¯†ï¼Œäºæ˜¯è¿™ä¸ªå¯¹è±¡å°±è¢«æ ‡è¯†ä¸ºå¯åˆ°è¾¾å¯¹è±¡ã€‚
- **æ¸…é™¤é˜¶æ®µ**ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå¯¹å †å†…å­˜ä»å¤´åˆ°å°¾è¿›è¡Œçº¿æ€§éå†ï¼Œå¦‚æœå‘ç°æœ‰å¯¹è±¡æ²¡æœ‰è¢«æ ‡è¯†ä¸ºå¯åˆ°è¾¾å¯¹è±¡ï¼Œé‚£ä¹ˆå°±å°†æ­¤å¯¹è±¡å ç”¨çš„å†…å­˜å›æ”¶ï¼Œå¹¶ä¸”å°†åŸæ¥æ ‡è®°ä¸ºå¯åˆ°è¾¾å¯¹è±¡çš„æ ‡è¯†æ¸…é™¤ï¼Œä»¥ä¾¿è¿›è¡Œä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ“ä½œã€‚

**å±€é™**

- ç”±äºæ˜¯ä»æ ¹å¯¹è±¡(å…¨å±€å¯¹è±¡)å¼€å§‹æŸ¥æ‰¾ï¼Œå¯¹äºé‚£äº›æ— æ³•ä»æ ¹å¯¹è±¡æŸ¥è¯¢åˆ°çš„å¯¹è±¡éƒ½å°†è¢«æ¸…é™¤
- å›æ”¶åä¼šå½¢æˆå†…å­˜ç¢ç‰‡ï¼Œå½±å“åé¢ç”³è¯·å¤§çš„è¿ç»­å†…å­˜ç©ºé—´
**å½“å†…å­˜è€—å°½æ—¶ï¼Œç¨‹åºå°†ä¼šè¢«æŒ‚èµ·ï¼Œåƒåœ¾å›æ”¶å¼€å§‹æ‰§è¡Œã€‚**

#### chrome V8 åƒåœ¾å›æ”¶ç®—æ³•

Chrome æµè§ˆå™¨æ‰€ä½¿ç”¨çš„ V8 å¼•æ“å°±æ˜¯é‡‡ç”¨çš„åˆ†ä»£å›æ”¶ç­–ç•¥ã€‚è¿™ä¸ªå’Œ Java å›æ”¶ç­–ç•¥æ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚ç›®çš„æ˜¯é€šè¿‡**åŒºåˆ†ã€Œ****ä¸´æ—¶****ã€ä¸ã€Œ****æŒä¹…****ã€**å¯¹è±¡ï¼›**å¤šå›æ”¶ã€Œä¸´æ—¶å¯¹è±¡åŒºã€ï¼ˆæ–°ç”Ÿä»£**younggenerationï¼‰ï¼Œ**å°‘å›æ”¶ã€ŒæŒä¹…å¯¹è±¡åŒºã€ï¼ˆè€ç”Ÿä»£** tenured generationï¼‰ï¼Œå‡å°‘æ¯æ¬¡éœ€éå†çš„å¯¹è±¡ï¼Œä»è€Œå‡å°‘æ¯æ¬¡GCçš„è€—æ—¶ã€‚

1. å†…å­˜æ³„æ¼
 åœ¨ JS ä¸­ï¼Œå¸¸è§çš„å†…å­˜æ³„éœ²ä¸»è¦æœ‰ 4 ç§,**å…¨å±€å˜é‡ã€é—­åŒ…ã€DOM å…ƒç´ çš„å¼•ç”¨ã€å®šæ—¶å™¨**

## EventLoopäº‹ä»¶å¾ªç¯

`JS`æ˜¯å•çº¿ç¨‹çš„ï¼Œä¸ºäº†é˜²æ­¢ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæ—¶é—´è¿‡é•¿é˜»å¡åé¢çš„ä»£ç ï¼Œæ‰€ä»¥ä¼š**å…ˆå°†åŒæ­¥ä»£ç å‹å…¥æ‰§è¡Œæ ˆä¸­ï¼Œä¾æ¬¡æ‰§è¡Œï¼Œå°†å¼‚æ­¥ä»£ç æ¨å…¥å¼‚æ­¥é˜Ÿåˆ—ï¼Œå¼‚æ­¥é˜Ÿåˆ—åˆåˆ†ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå› ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—çš„æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œæ‰€ä»¥å¾®ä»»åŠ¡é˜Ÿåˆ—è¦ä¼˜å…ˆäºå®ä»»åŠ¡é˜Ÿåˆ—**

### æµè§ˆå™¨äº‹ä»¶ç¯

äº‹ä»¶ç¯çš„è¿è¡Œæœºåˆ¶æ˜¯ï¼Œå…ˆä¼šæ‰§è¡Œæ ˆä¸­çš„å†…å®¹ï¼Œæ ˆä¸­çš„å†…å®¹æ‰§è¡Œåæ‰§è¡Œå¾®ä»»åŠ¡ï¼Œå¾®ä»»åŠ¡æ¸…ç©ºåå†æ‰§è¡Œå®ä»»åŠ¡ï¼Œå…ˆå–å‡ºä¸€ä¸ªå®ä»»åŠ¡ï¼Œå†å»æ‰§è¡Œå¾®ä»»åŠ¡ï¼Œç„¶ååœ¨å–å®ä»»åŠ¡æ¸…å¾®ä»»åŠ¡è¿™æ ·ä¸åœçš„å¾ªç¯ã€‚

![](image/image_1.png "")

æµè§ˆå™¨ä¸­çš„ä»»åŠ¡æº(task):

- `å®ä»»åŠ¡(macrotask)`ï¼š  
 å®¿ä¸»ç¯å¢ƒæä¾›çš„ï¼Œæ¯”å¦‚æµè§ˆå™¨  
 ajaxã€setTimeoutã€setIntervalã€setTmmediate(åªå…¼å®¹ie)ã€scriptã€requestAnimationFrameã€messageChannelã€UIæ¸²æŸ“ã€ä¸€äº›æµè§ˆå™¨api
- `å¾®ä»»åŠ¡(microtask)`ï¼š  
 è¯­è¨€æœ¬èº«æä¾›çš„ï¼Œæ¯”å¦‚promise.then  
 thenã€queueMicrotask(åŸºäºthen)ã€mutationObserver(æµè§ˆå™¨æä¾›)ã€messageChannel ã€mutationObersve

![](image/image_2.png "")

## setTimeoutã€Promiseã€Async/Await çš„åŒºåˆ«

- setTimeout
 settimeoutçš„å›è°ƒå‡½æ•°æ”¾åˆ°å®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œç­‰åˆ°æ‰§è¡Œæ ˆæ¸…ç©ºä»¥åæ‰§è¡Œã€‚
- Promise
 Promiseæœ¬èº«æ˜¯**åŒæ­¥çš„ç«‹å³æ‰§è¡Œå‡½æ•°**ï¼Œ å½“åœ¨executorä¸­æ‰§è¡Œresolveæˆ–è€…rejectçš„æ—¶å€™, æ­¤æ—¶æ˜¯å¼‚æ­¥æ“ä½œï¼Œ **ä¼šå…ˆæ‰§è¡Œthen/catchç­‰ï¼Œå½“ä¸»æ ˆå®Œæˆåï¼Œæ‰ä¼šå»è°ƒç”¨resolve/rejectä¸­å­˜æ”¾çš„æ–¹æ³•æ‰§è¡Œã€‚**

 ```javascript
 console.log('script start')
 let promise1 = new Promise(function (resolve) {
     console.log('promise1')
     resolve()
     console.log('promise1 end')
 }).then(function () {
     console.log('promise2')
 })
 
 setTimeout(function(){
     console.log('settimeout')
 })
 
 console.log('script end')
 
 // è¾“å‡ºé¡ºåº: 
 //script start->promise1->promise1 end->script end->promise2->settimeout
 ```

- async/await
 **async å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡**ï¼Œå½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œ**ä¸€æ—¦é‡åˆ° await å°±ä¼šå…ˆè¿”å›**ï¼Œç­‰åˆ°è§¦å‘çš„å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæ˜¯è®©å‡ºäº†çº¿ç¨‹ï¼Œ**è·³å‡ºäº† async å‡½æ•°ä½“**ã€‚
 è®²çš„è¶…çº§å¥½ğŸ‘‡

 [https://juejin.cn/post/6844903734321872910](https://juejin.cn/post/6844903734321872910)

 ```javascript
 async function async1(){
    console.log('async1 start');
    await async2();
    console.log('async1 end')
 }
 async function async2(){
    console.log('async2')
 }
 
 console.log('script start');
 async1();
 console.log('script end')
 
 // è¾“å‡ºé¡ºåºï¼šscript start->async1 start->async2->script end->async1 end
 
 
 ```

## é˜²æŠ–èŠ‚æµ

**é˜²æŠ–**ï¼šå‡½æ•°é˜²æŠ–ï¼Œå°±æ˜¯æŒ‡**è§¦å‘äº‹ä»¶åï¼Œå‡½æ•°åœ¨ n ç§’ååªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåœ¨ n ç§’å†…åˆè§¦å‘äº†äº‹ä»¶ï¼Œåˆ™ä¼šé‡æ–°è®¡ç®—å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€‚**

ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªäº‹ä»¶è¢«è§¦å‘å‡†å¤‡æ‰§è¡Œäº‹ä»¶å‡½æ•°å‰ï¼Œä¼šç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼ˆè¿™æ—¶é—´æ˜¯ç å†œè‡ªå·±å»å®šä¹‰çš„ï¼Œæ¯”å¦‚ 1 ç§’ï¼‰ï¼Œå¦‚æœæ²¡æœ‰å†æ¬¡è¢«è§¦å‘ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œï¼Œå¦‚æœè¢«è§¦å‘äº†ï¼Œé‚£å°±æœ¬æ¬¡ä½œåºŸï¼Œé‡æ–°ä»æ–°è§¦å‘çš„æ—¶é—´å¼€å§‹è®¡ç®—ï¼Œå¹¶å†æ¬¡ç­‰å¾… 1 ç§’ï¼Œç›´åˆ°èƒ½æœ€ç»ˆæ‰§è¡Œï¼

é˜²æŠ–ï¼šæœç´¢æ¡†æœç´¢è¾“å…¥ï¼Œå¹¶åœ¨è¾“å…¥å®Œä»¥åè‡ªåŠ¨æœç´¢ã€æ‰‹æœºå·ï¼Œé‚®ç®±éªŒè¯è¾“å…¥æ£€æµ‹ã€çª—å£å¤§å° resize å˜åŒ–åï¼Œå†é‡æ–°æ¸²æŸ“ã€‚

**èŠ‚æµ**ï¼šäº‹ä»¶è§¦å‘åï¼Œè§„å®šæ—¶é—´å†…ï¼Œäº‹ä»¶å¤„ç†å‡½æ•°ä¸èƒ½å†æ¬¡è¢«è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨**è§„å®šçš„æ—¶é—´å†…ï¼Œå‡½æ•°åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œä¸”æ˜¯æœ€å…ˆè¢«è§¦å‘è°ƒç”¨çš„é‚£æ¬¡ã€‚**

èŠ‚æµï¼šæ»šåŠ¨åŠ è½½æ›´å¤šã€æœç´¢æ¡†æœçš„ç´¢è”æƒ³åŠŸèƒ½ã€é«˜é¢‘ç‚¹å‡»ã€è¡¨å•é‡å¤æäº¤â€¦â€¦  

### é˜²æŠ–

```javascript
function debounce(fn,delay){
//è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨
  let timer = null
  //è¿”å›é—­åŒ…å‡½æ•°
  return function(){
  //é˜²æŠ–æ˜¯æŒ‡å¤šæ¬¡å‡ºå‘çš„æ—¶å€™ï¼Œé‡æ–°è®¡æ—¶å¹¶æ‰§è¡Œæœ€åä¸€æ¬¡
  //æ¸…é™¤å®šæ—¶å™¨
    clearTimeout(timer)
    //é‡æ–°å¼€å¯å®šæ—¶å™¨
    timer = setTimeout(()=>{
      fn.apply(this)
    },delay)
  }
}
```

### èŠ‚æµ

```javascript
function throttle(fn,delay){
  //è®°å½•ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´
  let lasttime=null
  return function(){
    //è®¾ç½®å½“å‰çš„å®æ—¶é—´
    let nowtime = Date.now()
    //èŠ‚æµæ˜¯æŒ‡è§„å®šæ—¶é—´å†…åªè§¦å‘æœ€åä¸€æ¬¡
    //æ‰€ä»¥å¦‚æœå½“å‰çš„æ—¶é—´å‡å»ç¬¬ä¸€æ¬¡è§¦å‘çš„äº‹ä»¶å¤§äºæˆ–è€…ç­‰äºè§„å®šçš„æ—¶é—´çš„æ—¶å€™å°±æ‰§è¡Œå‡½æ•°
    if(nowtime-lasttime>=delay){
      fn.call(this)
      //è®°å½•è¿™ä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´
      lasttime = nowtime
      }    
    }
}
```

## æ•°ç»„å»é‡

### åŒforå¾ªç¯

```javascript
for distinct(arr){
  for(let i = 0,len = arr.length;i<len;i++){
    for(let j = i+1;j<len;j++){
      if(arr[i]==arr[j]){
         arr.splice(j,1);
         //splice(<å¼€å§‹çš„ä½ç½®>,<ä¿®å‰ªçš„é•¿åº¦>)
         //spliceä¼šæ”¹å˜æ•°ç»„çš„é•¿åº¦ï¼Œæ‰€ä»¥è¦å°†æ•°ç»„çš„é•¿åº¦lenå’Œä¸‹æ ‡jå‡ä¸€
         len--;
         j--;
       }
    }
  }
}
```

å…ˆå®šä¹‰ä¸€ä¸ªåŒ…å«åŸå§‹æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œç„¶åéå†åŸå§‹æ•°ç»„ï¼Œå°†åŸå§‹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸æ–°æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœä¸é‡å¤åˆ™æ·»åŠ åˆ°æ–°æ•°ç»„ä¸­ï¼Œæœ€åè¿”å›æ–°æ•°ç»„ï¼›å› ä¸ºå®ƒçš„æ—¶é—´å¤æ‚åº¦æ˜¯`O(n^2)`ï¼Œå¦‚æœæ•°ç»„é•¿åº¦å¾ˆå¤§ï¼Œ`æ•ˆç‡ä¼šå¾ˆä½`

#### Array.filter() åŠ  indexOf

```javascript
function distinct(a,b){
//concat():ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚æ­¤æ–¹æ³•ä¸ä¼šæ›´æ”¹ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„
  let arr = a.concat(b)
  //filter():æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„, å…¶åŒ…å«é€šè¿‡**æ‰€æä¾›å‡½æ•°å®ç°çš„æµ‹è¯•**çš„æ‰€æœ‰å…ƒç´ ã€‚
  return arr.filter((item,index)=>{
    //indexOf():æ–¹æ³•è¿”å›åœ¨æ•°ç»„ä¸­å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç»™å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1ã€‚
    return arr.indexOf(item)===index
  })
}
```

åˆ©ç”¨indexOfæ£€æµ‹å…ƒç´ åœ¨æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®æ˜¯å¦å’Œå…ƒç´ ç°åœ¨çš„ä½ç½®ç›¸ç­‰ï¼Œå¦‚æœä¸ç­‰åˆ™è¯´æ˜è¯¥å…ƒç´ æ˜¯é‡å¤å…ƒç´ 

#### Array.sort() åŠ ä¸€è¡Œéå†å†’æ³¡(ç›¸é‚»å…ƒç´ å»é‡)

```javascript
function distinct(array){
  var res = []
  var sortedArray = array.concat().sort();
  var seen;
  for(var i = 0,len = sortedArray.length;i<len;i++){
    //ç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ ä¹‹é—´å¯¹æ¯”
    if(!i || seen !==sortedArray[i]){
    //å¦‚æœä¸ç›¸åŒçš„æ—¶å€™å°±æ’å…¥è¿™ä¸ªå…ƒç´ åˆ°æ–°çš„æ•°ç»„ä¹‹ä¸­
      res.push(sortedArray[i])
    }
    //seen å¤åˆ¶ä¸ºä¸Šä¸€ä¸ªå€¼
    seen = sortedArray[i]
  }
  return res;
}  
```

è°ƒç”¨äº†æ•°ç»„çš„æ’åºæ–¹æ³• sort()ï¼ŒV8å¼•æ“ çš„ sort() æ–¹æ³•åœ¨æ•°ç»„é•¿åº¦å°äºç­‰äº10çš„æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨æ’å…¥æ’åºï¼Œå¤§äº10çš„æƒ…å†µä¸‹ä¼šä½¿ç”¨å¿«é€Ÿæ’åºã€‚ç„¶åæ ¹æ®æ’åºåçš„ç»“æœè¿›è¡Œéå†åŠç›¸é‚»å…ƒç´ æ¯”å¯¹(å…¶å®å°±æ˜¯ä¸€è¡Œå†’æ³¡æ’åºæ¯”è¾ƒ)ï¼Œå¦‚æœç›¸ç­‰åˆ™è·³è¿‡è¯¥å…ƒç´ ï¼Œç›´åˆ°éå†ç»“æŸã€‚

#### ES6 ä¸­çš„ Set å»é‡

```javascript
function distinct(array) {
//Array.from():æ–¹æ³•å¯¹ä¸€ä¸ªç±»ä¼¼æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œæµ…æ‹·è´çš„æ•°ç»„å®ä¾‹ã€‚
   return Array.from(new Set(array));
}
//ç®€åŒ–
function unique(array) {
    return [...new Set(array)];
}
**//ç®€åŒ–
let unique = (a) => [...new Set(a)]**
```

ES6 æä¾›äº†æ–°çš„æ•°æ®ç»“æ„ Setï¼Œ**Set ç»“æ„çš„ä¸€ä¸ªç‰¹æ€§å°±æ˜¯æˆå‘˜å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚**(åŒæ—¶è¯·å¤§å®¶æ³¨æ„è¿™ä¸ªç®€åŒ–è¿‡ç¨‹)

#### Object é”®å€¼å¯¹

#### reduce å®ç°å¯¹è±¡æ•°ç»„å»é‡å¤

- `console.log(NaN === NaN); // false`, indexOf åº•å±‚ä½¿ç”¨çš„æ˜¯ === è¿›è¡Œåˆ¤æ–­
- Setå¯ä»¥å»é‡NaNç±»å‹ï¼Œ Setå†…éƒ¨è®¤ä¸ºå°½ç®¡ NaN === NaN ä¸º falseï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªå…ƒç´ æ˜¯é‡å¤çš„ã€‚
- ç®€å•è¯´ä¸‹ lodash çš„ uniq æ–¹æ³•çš„æºç å®ç°ã€‚
è¿™ä¸ªæ–¹æ³•çš„è¡Œä¸ºå’Œä½¿ç”¨ Set è¿›è¡Œå»é‡çš„ç»“æœä¸€è‡´ã€‚
å½“æ•°ç»„é•¿åº¦å¤§äºç­‰äº 200 æ—¶ï¼Œä¼šåˆ›å»º Set å¹¶å°† Set è½¬æ¢ä¸ºæ•°ç»„æ¥è¿›è¡Œå»é‡ï¼ˆSet ä¸å­˜åœ¨æƒ…å†µçš„å®ç°ä¸åšåˆ†æï¼‰ã€‚å½“æ•°ç»„é•¿åº¦å°äº 200 æ—¶ï¼Œä¼šä½¿ç”¨ç±»ä¼¼å‰é¢æåˆ°çš„ åŒé‡å¾ªç¯ çš„å»é‡æ–¹æ¡ˆï¼Œå¦å¤–è¿˜ä¼šåš NaN çš„å»é‡ã€‚
- **åŒé‡ for å¾ªç¯ > Array.filter()åŠ  indexOf > Array.sort() åŠ ä¸€è¡Œéå†å†’æ³¡ > Object é”®å€¼å¯¹å»é‡å¤ > ES6ä¸­çš„Setå»é‡**
